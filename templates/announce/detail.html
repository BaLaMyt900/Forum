{% extends 'main.html' %}
{% block title %}Создание объявления{% endblock title %}
{% block extra_head %}
    {% load static %}
    {% load humanize %}
{% endblock extra_head %}
{% block body %}
<div class="card">
    <div class="card-header">{{ object.title }}</div>
    <div class="card-body">
        {{ object.text|safe }}
    </div>
    <div class="card-footer">
        Автор: {{ object.author }}<br>
        {{ object.date }}<br>
        {{ object.data|timesince }}
    </div>
</div>
<div class="card my-2">
    <div class="card-header">Отзывы</div>
    <div class="card-body">
        <form id="response_form">
            <input name="announce" value="{{ object.pk }}" type="hidden">
            <label class="form-label" for="response_text">Текст</label>
            <textarea class="form-control" name="text" id="response_text" cols="30" rows="5" maxlength="300"></textarea>
            <button class="btn btn-outline-success my-2" type="submit">Отправить отзыв</button>
        </form>
        <div id="responce_succsess" class="p-1 d-none">
            Ваш отзыв успешно отправлен! Как только автор объявления проверит его и утвердит, он будет добавлен на страницу!
        </div>
    </div>
    <div class="card-footer">
        {% if not response %}
            <h3>Комментариев пока нет! Будьте первым!</h3>
        {% else %}
            {% for comm in response %}
            <div class="card my-2">
                <div class="card-header">{{ comm.author }}</div>
                <div class="card-body">{{ comm.text }}</div>
                <div class="card-footer">
                    {{ comm.date }}
                    {% if request.user.pk == object.author.pk %}
                        <div role="group" class="btn-group">
{#                        TODO: Доделать публикацию при + и удаление при -#}
                            <button class="btn btn-outline-success">Разрешить</button>
                            <button class="btn btn-outline-danger">Запретить</button>
                        </div>
                    {% endif %}
                </div>
            </div>
            {%  endfor %}
        {% endif %}
   </div>
</div>
{% endblock body %}
{% block scripts %}
    <script src="{% static 'response.js' %}"></script>
{% endblock scripts %}